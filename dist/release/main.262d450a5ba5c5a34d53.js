!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){"use strict";n.r(t),n.d(t,"MemoryPool",function(){return r});class r{constructor(e){this.byteLength=e,this.stack=[]}push(e){if(e.byteLength<this.byteLength)throw new Error(`Can't absorb buffer. byteLength must be at least ${this.byteLength}`);this.stack.push(e)}pushAll(e){for(let t=0;t<e.length;t++)this.push(e[t])}acquire(){return this.stack.pop()||new ArrayBuffer(this.byteLength)}drain(){const e=this.stack;return this.stack=[],e}}},function(e,t,n){var r;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var i=typeof r;if("string"===i||"number"===i)e.push(r);else if(Array.isArray(r)&&r.length){var a=o.apply(null,r);a&&e.push(a)}else if("object"===i)for(var l in r)n.call(r,l)&&r[l]&&e.push(l)}}return e.join(" ")}void 0!==e&&e.exports?(o.default=o,e.exports=o):void 0===(r=function(){return o}.apply(t,[]))||(e.exports=r)}()},,,,function(e,t,n){"use strict";var r=function(e,t){var n=v,r=m;null===n&&console.warn("computations created without a root or parent will never be disposed");var o=new l(e,t);return v=m=o,null===p?function(e){p=g,g.changes.reset(),g.updates.reset();try{e.value=e.fn(e.value),(g.changes.count>0||g.updates.count>0)&&(g.time++,y(g))}finally{p=v=m=null}}(o):o.value=o.fn(o.value),n&&n!==w&&(null===n.owned?n.owned=[o]:n.owned.push(o)),v=n,m=r,function(){if(null!==m){if(o.age===g.time){if(o.state===f)throw new Error("circular dependency");z(o)}!function(e,t){null===e.log&&(e.log=new u);x(e.log,t)}(o,m)}return o.value}};Object.defineProperty(r,"default",{value:r});var o=r;r.root=function(e){var t=v,n=0===e.length?w:new l(null,null),r=void 0,o=0===e.length?null:function(){null!==p?g.disposes.add(n):T(n)};return v=n,null===p?r=function(e,t,n){try{return null===t?e():e(t)}finally{v=n}}(e,o,t):(r=null===o?e():e(o),v=t),r},r.on=function(e,t,n,o){return Array.isArray(e)&&(e=function(e){return function(){for(var t=0;t<e.length;t++)e[t]()}}(e)),o=!!o,r(i,n);function i(n){var r=m;return e(),o?o=!1:(m=null,n=t(n),m=r),n}},r.data=function(e){var t=new a(e);return function(e){if(arguments.length>0){if(null!==p)if(t.pending!==c){if(e!==t.pending)throw new Error("conflicting changes: "+e+" !== "+t.pending)}else t.pending=e,g.changes.add(t);else null!==t.log?(t.pending=e,g.changes.add(t),C()):t.value=e;return e}return null!==m&&function(e,t){null===e.log&&(e.log=new u);x(e.log,t)}(t,m),t.value}},r.value=function(e,t){var n=r.data(e),o=-1;return function(r){if(0===arguments.length)return n();if(!(t?t(e,r):e===r)){var i=g.time;if(o===i)throw new Error("conflicting values: "+r+" is not the same as "+e);o=i,e=r,n(r)}return r}},r.freeze=function(e){var t=void 0;if(null!==p)t=e();else{(p=g).changes.reset();try{t=e(),C()}finally{p=null}}return t},r.sample=function(e){var t,n=m;return null!==n?(m=null,t=e(),m=n):t=e(),t},r.cleanup=function(e){null!==v?null===v.cleanups?v.cleanups=[e]:v.cleanups.push(e):console.warn("cleanups created without a root or parent will never be run")};var i=function(){return function(){this.time=0,this.changes=new s,this.updates=new s,this.disposes=new s}}(),a=function(){return function(e){this.value=e,this.pending=c,this.log=null}}(),l=function(){return function(e,t){this.fn=e,this.value=t,this.state=d,this.source1=null,this.source1slot=0,this.sources=null,this.sourceslots=null,this.log=null,this.owned=null,this.cleanups=null,this.age=g.time}}(),u=function(){return function(){this.node1=null,this.node1slot=0,this.nodes=null,this.nodeslots=null}}(),s=function(){function e(){this.items=[],this.count=0}return e.prototype.reset=function(){this.count=0},e.prototype.add=function(e){this.items[this.count++]=e},e.prototype.run=function(e){for(var t=this.items,n=0;n<this.count;n++)e(t[n]),t[n]=null;this.count=0},e}(),c={},d=0,h=1,f=2,g=new i,p=null,m=null,v=null,w=new l(null,null);function x(e,t){var n,r=null===t.source1?-1:null===t.sources?0:t.sources.length;null===e.node1?(e.node1=t,e.node1slot=r,n=-1):null===e.nodes?(e.nodes=[t],e.nodeslots=[r],n=0):(n=e.nodes.length,e.nodes.push(t),e.nodeslots.push(r)),null===t.source1?(t.source1=e,t.source1slot=n):null===t.sources?(t.sources=[e],t.sourceslots=[n]):(t.sources.push(e),t.sourceslots.push(n))}function C(){var e=v;g.updates.reset(),g.time++;try{y(g)}finally{p=m=null,v=e}}function y(e){var t=p,n=0;for(p=e,e.disposes.reset();0!==e.changes.count||0!==e.updates.count||0!==e.disposes.count;)if(n>0&&e.time++,e.changes.run(b),e.updates.run(z),e.disposes.run(T),n++>1e5)throw new Error("Runaway clock detected");p=t}function b(e){e.value=e.pending,e.pending=c,e.log&&k(e.log)}function k(e){var t=e.node1,n=e.nodes;if(null!==t&&M(t),null!==n)for(var r=0,o=n.length;r<o;r++)M(n[r])}function M(e){var t=g.time;e.age<t&&(e.age=t,e.state=h,g.updates.add(e),null!==e.owned&&function e(t){for(var n=0;n<t.length;n++){var r=t[n];r.age=g.time,r.state=d,null!==r.owned&&e(r.owned)}}(e.owned),null!==e.log&&k(e.log))}function z(e){if(e.state===h){var t=v,n=m;v=m=e,e.state=f,S(e,!1),e.value=e.fn(e.value),e.state=d,v=t,m=n}}function S(e,t){var n,r,o=e.source1,i=e.sources,a=e.sourceslots,l=e.cleanups,u=e.owned;if(null!==l){for(n=0;n<l.length;n++)l[n](t);e.cleanups=null}if(null!==u){for(n=0;n<u.length;n++)T(u[n]);e.owned=null}if(null!==o&&(L(o,e.source1slot),e.source1=null),null!==i)for(n=0,r=i.length;n<r;n++)L(i.pop(),a.pop())}function L(e,t){var n,r,o=e.nodes,i=e.nodeslots;-1===t?e.node1=null:(n=o.pop(),r=i.pop(),t!==o.length&&(o[t]=n,i[t]=r,-1===r?n.source1slot=t:n.sourceslots[r]=t))}function T(e){e.fn=null,e.log=null,S(e,!0)}var P=3;function O(e,t){var n=e.start.parentNode,r=e.start,i=null,a=typeof t;for("string"===a||"number"===a?(t=t.toString(),r.nodeType===P?(r.data=t,i=r):(t=document.createTextNode(t),n.replaceChild(t,r),e.end===r&&(e.end=t),e.start=i=t)):t instanceof Node?(r!==t&&(n.replaceChild(t,r),e.end===r&&(e.end=t),e.start=t),i=t):Array.isArray(t)?function t(o){for(var a=0,l=o.length;a<l;a++){var u=o[a];i===e.end?u instanceof Node?i=e.end=i.nextSibling?n.insertBefore(u,i.nextSibling):n.appendChild(u):u instanceof Array?t(u):null!==u&&void 0!==u&&!1!==u&&!0!==u&&(u=document.createTextNode(u.toString()),i=e.end=i.nextSibling?n.insertBefore(u,i.nextSibling):n.appendChild(u)):u instanceof Node?(r!==u?null===i?(e.end===u&&(e.end=u.previousSibling),n.replaceChild(u,r),e.start=u,e.end===r&&(e.end=u),r=u.nextSibling):r.nextSibling===u&&r!==u.nextSibling&&r!==e.end?(n.removeChild(r),r=u.nextSibling):(e.end===u&&(e.end=u.previousSibling),n.insertBefore(u,r)):r=r.nextSibling,i=u):u instanceof Array?t(u):null!==u&&void 0!==u&&!0!==u&&!1!==u&&(u=u.toString(),r.nodeType===P?(r.data=u,null===i&&(e.start=r),r=(i=r).nextSibling):(u=document.createTextNode(u),n.insertBefore(u,r),null===i&&(e.start=u),i=u))}}(t):t instanceof Function?(o(function(){O(e,t())}),i=e.end):null!==t&&void 0!==t&&!0!==t&&!1!==t&&(t=t.toString(),r.nodeType===P?(r.data=t,i=r):(t=document.createTextNode(t),n.replaceChild(t,r),e.end===r&&(e.end=t),e.start=i=t)),null===i&&(e.start===n.firstChild&&e.end===n.lastChild&&e.start!==e.end?(n.textContent="",t=document.createTextNode(""),n.appendChild(t),i=e.start=e.end=t):r.nodeType===P?(r.data="",i=r):(t=document.createTextNode(""),n.replaceChild(t,r),e.end===r&&(e.end=t),e.start=i=t));i!==e.end;)r=e.end,e.end=r.previousSibling,n.removeChild(r);return e}function _(e,t,n){var r=typeof t;if(n===t);else if("string"===r)n=""!==n&&"string"==typeof n?e.firstChild.data=t:e.textContent=t;else if("number"===r)t=t.toString(),n=""!==n&&"string"==typeof n?e.firstChild.data=t:e.textContent=t;else if(null==t||"boolean"===r)U(e),n="";else if("function"===r)o(function(){n=_(e,t(),n)});else if(t instanceof Node)Array.isArray(n)?0===n.length?e.appendChild(t):1===n.length?e.replaceChild(t,n[0]):(U(e),e.appendChild(t)):""===n?e.appendChild(t):e.replaceChild(t,e.firstChild),n=t;else{if(!Array.isArray(t))throw new Error("content must be Node, stringable, or array of same");var i=function e(t,n){for(var r=0,o=n.length;r<o;r++){var i=n[r];i instanceof Node?t.push(i):null==i||!0===i||!1===i||(Array.isArray(i)?e(t,i):"string"==typeof i?t.push(i):t.push(i.toString()))}return t}([],t);0===i.length?U(e):Array.isArray(n)?0===n.length?q(e,i,0,i.length):B(e,n,i):""===n?q(e,i,0,i.length):B(e,[e.firstChild],i),n=i}return n}var E=-1,N=-2,R=0,A=16,D=1<<A,I=D-1;function B(e,t,n){var r,o,i,a=n.length,l=0,u=t.length-1,s=0,c=a-1,d=t[l],h=n[s],f=t[u],g=n[c],p=f.nextSibling,m=!0;e:for(;m;){for(m=!1;j(h,d,s,n);){if(l++,++s>c||l>u)break e;h=n[s],d=t[l]}for(;j(g,f,c,n);){if(p=f,u--,s>--c||l>u)break e;g=n[c],f=t[u]}for(;j(h,f,s,n);){if(m=!0,e.insertBefore(f,d),u--,++s>c||l>u)break e;h=n[s],f=t[u]}for(;j(g,d,c,n);){if(m=!0,null===p?e.appendChild(d):e.insertBefore(d,p),p=d,l++,s>--c||l>u)break e;g=n[c],d=t[l]}}if(s>c)for(;l<=u;)e.removeChild(t[u]),u--;else if(l>u)for(;s<=c;)F(e,n[s],p,s,n),s++;else{var v=[];for(r=l,o=(l<<A)+(R=(R+1)%D);r<=u;r++,o+=D)void 0===(d=t[r]).__surplus_order?Object.defineProperty(d,"__surplus_order",{value:o,writable:!0}):d.__surplus_order=o,d instanceof Text&&v.push(r);var w=new Array(c-s+1),x=[],C=0;for(r=s;r<=c;r++)"string"==typeof(h=n[r])?(x.push(r),w[r-s]=E):void 0!==(o=h.__surplus_order)&&(o&I)===R?(o>>=A,w[r-s]=o,t[o]=null,C++):w[r-s]=E;if(0!==C||0!==l||u!==t.length-1){var y=function(e){for(var t=[],n=[],r=-1,o=new Array(e.length),i=0,a=e.length;i<a;i++){var l=e[i];if(!(l<0)){var u=Y(t,l);-1!==u&&(o[i]=n[u]),u===r?(t[++r]=l,n[r]=i):l<t[u+1]&&(t[u+1]=l,n[u+1]=i)}}for(i=n[r];r>=0;i=o[i],r--)t[r]=i;return t}(w);for(r=0;r<y.length;r++)w[y[r]]=N;var b=0,k=0,M=0;for(r=0,o=0,i=0;r<x.length;r++){for(b=x[r];o<y.length&&(k=y[o])<b-s;)o++;for(;i<v.length&&(M=v[i],0!==o)&&M<w[y[o-1]];)i++;i<v.length&&(o===y.length||M<w[k])?(d=t[M],h=n[b],d.data!==h&&(d.data=h),t[M]=null,n[b]=d,w[b]=N,i++):n[b]=document.createTextNode(n[b])}for(;l<=u;)null!==(d=t[l])&&e.removeChild(d),l++;for(;s<=c;)g=n[c],w[c-s]!==N&&(null===p?e.appendChild(g):e.insertBefore(g,p)),p=g,c--}else for(U(e);s<=c;)F(e,n[s],null,s,n),s++}}function j(e,t,n,r){return e===t||"string"==typeof e&&t instanceof Text&&(t.data!==e&&(t.data=e),r[n]=t,!0)}function q(e,t,n,r){for(var o;n<r;n++)(o=t[n])instanceof Node?e.appendChild(o):(o=t[n]=document.createTextNode(o),e.appendChild(o))}function F(e,t,n,r,o){"string"==typeof t&&(t=o[r]=document.createTextNode(t)),null===n?e.appendChild(t):e.insertBefore(t,n)}function U(e){e.textContent=""}function Y(e,t){var n=-1,r=e.length;if(r>0&&e[r-1]<=t)return r-1;for(;r-n>1;){var o=Math.floor((n+r)/2);e[o]>t?r=o:n=o}return n}function K(e,t,n){var r=document.createElement(e);return t&&(r.className=t),n&&n.appendChild(r),r}function X(e,t){var n=document.createTextNode(e);return t.appendChild(n),n}var $={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};new RegExp("^("+Object.keys($).join("|")+")-(.*)");const H=/^#?([0-9a-f])([0-9a-f])([0-9a-f])$/i,V=/^#?([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])$/i;class W{constructor(e,t,n){this.r=e,this.g=t,this.b=n}isValid(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255}toString(e={}){return this.isValid()?(e.hideHash?"":"#")+(J(this.r)+J(this.g)+J(this.b)).toLowerCase():"INVALID"}static parse(e){const t=e.match(H);if(t)return new W(G(t[1]+t[1]),G(t[2]+t[2]),G(t[3]+t[3]));const n=e.match(V);return n?new W(G(n[1]),G(n[2]),G(n[3])):null}static eq(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b}static invalid(){return new W(NaN,NaN,NaN)}}function G(e){return parseInt(e,16)}function J(e){return("00"+e.toString(16)).substr(-2)}function Q(e){const t=new URLSearchParams(e),n=t.get("c_re")?+t.get("c_re"):null,r=t.get("c_im")?+t.get("c_im"):null,o=t.get("ctr_re")?+t.get("ctr_re"):null,i=t.get("ctr_im")?+t.get("ctr_im"):null,a=t.get("zoom")?+t.get("zoom"):null,l=t.get("color_in")?W.parse(t.get("color_in")):null,u=t.get("color_out")?W.parse(t.get("color_out")):null,s=t.get("res")?+t.get("res"):null,c=t.get("iter")?+t.get("iter"):null,d=t.get("rad")?+t.get("rad"):null;return{canvas:{center:{re:null!==o?o:void 0,im:null!==i?i:void 0},zoom:null!==a&&a>0?a:void 0,resolution:null!==s&&s>0?s:void 0},escapeTime:{c:{re:null!==n?n:void 0,im:null!==r?r:void 0},maxIter:null!==c&&c>0?c:void 0,escapeRadius:null!==d&&d>0?d:void 0},imager:{includedColor:l||void 0,excludedColor:u||void 0}}}const Z={height:32,width:32};function ee({canvasSizeBrowserPx:e,resolution:t,center:n,origin:r,chunkDelta:i}){const a={width:()=>null===e.width()?null:e.width()*t(),height:()=>null===e.height()?null:e.height()*t()},l=()=>(n.re()-r.re())/i.re(),u=()=>(n.im()-r.im())/i.im(),s={x:()=>null===a.width()?null:-l()*Z.width+a.width()/2,y:()=>null===a.height()?null:-u()*Z.height+a.height()/2},c=()=>null===s.x()?null:-s.x()/Z.width,d=()=>null===s.y()?null:-s.y()/Z.height,h=()=>null===c()||null===a.width()?null:c()+a.width()/Z.width,f=()=>null===d()||null===a.height()?null:d()+a.height()/Z.height,g=o(()=>{if(null===c()||null===d()||null===h()||null===f())return null;const e={re:Math.floor(c()),im:Math.floor(d())};return{topLeft:e,widthChunks:Math.ceil(h())-e.re,heightChunks:Math.ceil(f())-e.im}});return{canvasSizeLogicalPx:a,originOffsetPx:s,canvasRect:g}}var te=n(0);class ne{map(e,t){return void 0===t?new oe(this,e):new oe(this,e,t)}crack(){return this.currentSlots().map(e=>o.sample(e))}}class re extends ne{constructor(){super(),this.chunks=new Map}get(e){const t=ie(e),n=this.chunks.get(t)||o.data(null);return this.chunks.set(t,n),n}currentSlots(){const e=[];return this.chunks.forEach(t=>e.push(t)),e}}class oe extends ne{constructor(e,t,n){super(),this.original=e,this.mapFn=t,this.seedFactory=n,this.chunks=new Map,o.cleanup(()=>{this.chunks.forEach(({dispose:e})=>e())})}get(e){const t=ie(e);let n=this.chunks.get(t);if(!n){let r;const i=this.original.get(e),a=o.root(t=>(r=t,this.seedFactory?o(t=>this.mapFn(i(),e,t),this.seedFactory(e)):o(()=>this.mapFn(i(),e))));n={dispose:r,value:a},this.chunks.set(t,n)}return n.value}currentSlots(){const e=[];return this.chunks.forEach(t=>e.push(t.value)),e}}function ie(e){return`${e.re}+${e.im}i`}function ae(e,t,n){const r={re:o.value(n.c.re),im:o.value(n.c.im)},i=o.value(n.maxIter),a=o.value(n.escapeRadius),l=new te.MemoryPool(Z.width*Z.height*2),u=o(()=>({escapeTime:{c:{re:r.re(),im:r.im()},maxIter:i(),escapeRadius:a()},canvas:e.canvasConfig()})),s=o.on(u,e=>e+1,-1),c=o(()=>{u();const e=new re;return o.cleanup(()=>e.crack().forEach(e=>{e&&l.push(e.buffer)})),e.map((e,t,n)=>(n&&e!==n&&l.push(n.buffer),e),()=>null),e}),d=new Worker(t);d.onmessage=(e=>{const t=e.data;if("startup-failure"===t.type)throw new Error(t.err);"chunk-update"===t.type&&t.dataGen===s()&&c().get(t.chunkId)(new Uint16Array(t.data))});const h={type:"worker-init",worker:{chunkSizePx:Z,pauseInterval:250}};d.postMessage(h);let f=0;return o(()=>{const t={type:"worker-reset",escapeTime:u().escapeTime,canvas:u().canvas,dataGen:s(),seqNo:f++};d.postMessage(t),o(t=>{const n=l.drain(),r=e.rect.canvasRect(),o={type:"add-jobs",jobs:r?t?function(e,t){const n=[],r={topLeft:e.topLeft,widthChunks:e.widthChunks,heightChunks:Math.max(Math.min(t.topLeft.im-e.topLeft.im,e.heightChunks),0)};r.widthChunks*r.heightChunks>0&&n.push(r);const o=e.topLeft.im+e.heightChunks,i=t.topLeft.im+t.heightChunks,a=Math.max(Math.min(o-i,e.heightChunks),0),l={topLeft:{re:e.topLeft.re,im:o-a},widthChunks:e.widthChunks,heightChunks:a};l.widthChunks*l.heightChunks>0&&n.push(l);const u=r.topLeft.im+r.heightChunks,s=Math.max(l.topLeft.im-u,0),c={topLeft:{re:e.topLeft.re,im:u},widthChunks:Math.max(Math.min(t.topLeft.re-e.topLeft.re,e.widthChunks),0),heightChunks:s};c.widthChunks*c.heightChunks>0&&n.push(c);const d=e.topLeft.re+e.widthChunks,h=t.topLeft.re+t.widthChunks,f=Math.max(Math.min(d-h,e.widthChunks),0),g={topLeft:{re:d-f,im:u},widthChunks:f,heightChunks:s};g.widthChunks*g.heightChunks>0&&n.push(g);return n}(r,t):[r]:[],seqNo:f++,buffers:n};return d.postMessage(o,n),r},null)}),{c:r,maxIter:i,escapeRadius:a,resultData:c,currentOpts:function(){return{c:{re:r.re(),im:r.im()},maxIter:i(),escapeRadius:a()}},updateOpts:function(e){o.freeze(()=>{r.re(e.c.re),r.im(e.c.im),i(e.maxIter),a(e.escapeRadius)})}}}function le(e,t){const n=o.value(t.includedColor,W.eq),r=o.value(t.excludedColor,W.eq),i=o(()=>(function(e,t){return{r:n=>Math.round(n*e.r+(1-n)*t.r),g:n=>Math.round(n*e.g+(1-n)*t.g),b:n=>Math.round(n*e.b+(1-n)*t.b)}})(n(),r())),a=new te.MemoryPool(Z.width*Z.height*4),l=o(()=>{const t=e.resultData().map((t,n,r)=>{if(!t)return r&&a.push(r.data.buffer),null;const o=i(),l=e.maxIter(),u=r?r.data:new Uint8ClampedArray(a.acquire());for(let e=0;e/4<t.length&&e<u.length;e+=4){const n=t[e/4]/l;u[e]=o.r(n),u[e+1]=o.g(n),u[e+2]=o.b(n),u[e+3]=255}return new ImageData(u,Z.width,Z.height)},()=>null);return o.cleanup(()=>t.crack().forEach(e=>{e&&a.push(e.data.buffer)})),t});return{includedColor:n,excludedColor:r,imageData:l,currentOpts:function(){return{includedColor:n(),excludedColor:r()}},updateOpts:function(e){o.freeze(()=>{n(e.includedColor),r(e.excludedColor)})}}}function ue(e,t,n){return{color:function(e){const t=o.value(o.sample(()=>se.find(t=>W.eq(t.includedColor,e.includedColor())&&W.eq(t.excludedColor,e.excludedColor()))||null));return o.on(t,()=>{t()&&(e.includedColor(t().includedColor),e.excludedColor(t().excludedColor))},void 0,!0),{theme:t}}(n)}}const se=[{name:"Dark",includedColor:W.parse("#f00"),excludedColor:W.parse("#000")},{name:"Light",includedColor:W.parse("#0df"),excludedColor:W.parse("#fff")},{name:"High Contrast",includedColor:W.parse("#f9ffff"),excludedColor:W.parse("#000007")}];const ce={center:{re:0,im:0},zoom:150,resolution:1.25},de={c:{re:0,im:.8},maxIter:50,escapeRadius:2},he={includedColor:new W(255,0,0),excludedColor:new W(0,0,0)};function fe(e){const t=e.canvas||{},n=t.center||{},r=e.escapeTime||{},o=r.c||{},i=e.imager||{},a=i.includedColor||{},l=i.excludedColor||{};return{canvas:{center:{re:void 0!==n.re?n.re:ce.center.re,im:void 0!==n.im?n.im:ce.center.im},zoom:void 0!==t.zoom?t.zoom:ce.zoom,resolution:void 0!==t.resolution?t.resolution:ce.resolution},escapeTime:{c:{re:void 0!==o.re?o.re:de.c.re,im:void 0!==o.im?o.im:de.c.im},maxIter:void 0!==r.maxIter?r.maxIter:de.maxIter,escapeRadius:void 0!==r.escapeRadius?r.escapeRadius:de.escapeRadius},imager:{includedColor:new W(void 0!==a.r?a.r:he.includedColor.r,void 0!==a.g?a.g:he.includedColor.g,void 0!==a.b?a.b:he.includedColor.b),excludedColor:new W(void 0!==l.r?l.r:he.excludedColor.r,void 0!==l.g?l.g:he.excludedColor.g,void 0!==l.b?l.b:he.excludedColor.b)}}}function ge(e,t){const{canvas:n,escapeTime:r,imager:i}=fe(t),a=function(e){const t={width:o.value(null),height:o.value(null)},n=o.value(e.zoom),r=o.value(e.resolution),i={re:o.value(e.center.re),im:o.value(e.center.im)},a=()=>{n(),r()},l={re:o.on(a,()=>i.re()),im:o.on(a,()=>i.im())},u={re:()=>Z.width/n()/r(),im:()=>-Z.height/n()/r()},s=o(()=>({chunkDelta:{re:u.re(),im:u.im()},origin:{re:l.re(),im:l.im()}})),c=ee({canvasSizeBrowserPx:t,resolution:r,center:i,origin:l,chunkDelta:u});return{canvasSizeBrowserPx:t,resolution:r,zoom:n,center:i,origin:l,chunkDelta:u,canvasConfig:s,rect:c,currentOpts:function(){return{center:{re:i.re(),im:i.im()},zoom:n(),resolution:r()}},updateOpts:function(e){o.freeze(()=>o.sample(()=>{i.re(e.center.re),i.im(e.center.im),n(e.zoom),r(e.resolution)}))}}}(n),l=ae(a,e,r),u=le(l,i),s=ue(0,0,u);return{canvasMgr:a,runner:l,imager:u,settings:s,currentOpts:function(){return{canvas:a.currentOpts(),escapeTime:l.currentOpts(),imager:u.currentOpts()}},updateOpts:function(e){const t=fe(e);o.freeze(()=>{a.updateOpts(t.canvas),l.updateOpts(t.escapeTime),u.updateOpts(t.imager)})}}}const pe=({app:e})=>(function(){var t,n,r;return t=K("div","zoom-buttons",null),n=K("span","zoom-btn",t),r=K("span","zoom-btn",t),o(function(){n.onclick=(()=>e.canvasMgr.zoom(1.1*e.canvasMgr.zoom())),n.textContent="+"}),o(function(){r.onclick=(()=>e.canvasMgr.zoom(.9*e.canvasMgr.zoom())),r.textContent="-"}),t})(),me=({app:e})=>(function(){var t,n,r,i,a,l;return K("label","setting-label",n=K("div","setting",t=K("div","color-selector",null))).textContent="Theme",i=X("",r=K("select","color-dropdown",n)),(a=K("option",null,r)).value=-1,a.textContent="Custom",l=X("",t),o(function(e){return O(e,se.map((e,t)=>(function(){var n;return(n=K("option",null,null)).value=t,_(n,e.name,""),n})()))},{start:i,end:i}),o(function(){r.value=e.settings.color.theme()?se.indexOf(e.settings.color.theme()):-1,r.onchange=(t=>e.settings.color.theme(se[+t.currentTarget.value]||null))}),o(function(t){return O(t,!e.settings.color.theme()&&function(){var t,n,r,i,a;return K("label","setting-label",n=K("div","setting",t=K("div","color-custom",null))).textContent="Color In",r=K("input",null,n),K("label","setting-label",i=K("div","setting",t)).textContent="Color Out",a=K("input",null,i),o(function(){r.value=e.imager.includedColor().toString(),r.onchange=(t=>e.imager.includedColor(W.parse(t.currentTarget.value)||W.invalid()))}),o(function(){a.value=e.imager.excludedColor().toString(),a.onchange=(t=>e.imager.excludedColor(W.parse(t.currentTarget.value)||W.invalid()))}),t}())},{start:l,end:l}),t})();var ve=n(1);function we(e,t){const n=t||((e,t)=>e===t),r=o.data(!1),i=o.data(null),a=()=>r()?i():e(),l=e=>{if(void 0===e)return a();const t=o.sample(a);return n(e,t)?t:o.freeze(()=>(r(!0),i(e)))};return l.commit=(()=>{o.sample(()=>{r()&&o.freeze(()=>{e(i()),r(!1)})})}),l.revert=(()=>{o.freeze(()=>{r(!1),i(null)})}),l}const xe=e=>{const t={width:we(e.canvasMgr.canvasSizeBrowserPx.width),height:we(e.canvasMgr.canvasSizeBrowserPx.height)},n=we(e.canvasMgr.zoom),r={re:we(e.canvasMgr.center.re),im:we(e.canvasMgr.center.im)},o=()=>Math.abs(Z.width/n()/e.canvasMgr.chunkDelta.re()),i=ee({origin:e.canvasMgr.origin,chunkDelta:e.canvasMgr.chunkDelta,canvasSizeBrowserPx:t,resolution:o,center:r});return{canvasSizeBrowserPx:t,zoom:n,center:r,resolution:o,rect:i}},Ce=(e,t,n)=>r=>{if(n()){let n;i(e.canvasMgr.canvasSizeBrowserPx);const r=()=>{i(t.canvasSizeBrowserPx),void 0!==n&&clearTimeout(n),n=setTimeout(a,50)};window.addEventListener("resize",r),o.cleanup(()=>window.removeEventListener("resize",r))}function i({width:e,height:t}){const n=r.getBoundingClientRect();e(n.width),t(n.height)}function a(){t.canvasSizeBrowserPx.width.commit(),t.canvasSizeBrowserPx.height.commit()}},ye=(e,t)=>n=>{if(t.zoom()<e.canvasMgr.zoom())return;const{rect:r}=t,i=null===r.canvasSizeLogicalPx.width()||null===r.canvasSizeLogicalPx.height()?null:{width:r.canvasSizeLogicalPx.width(),height:r.canvasSizeLogicalPx.height()};if(!i)return;n.width=i.width,n.height=i.height;const a=n.getContext("2d");o(()=>{const t=null===r.originOffsetPx.x()||null===r.originOffsetPx.y()?null:{x:r.originOffsetPx.x(),y:r.originOffsetPx.y()},n=r.canvasRect();if(t&&n)for(let r=0;r<n.widthChunks;r++)for(let i=0;i<n.heightChunks;i++){const l={re:n.topLeft.re+r,im:n.topLeft.im+i},u={x:l.re*Z.width+t.x,y:l.im*Z.height+t.y};o(()=>{const t=e.imager.imageData().get(l)();t?a.putImageData(t,u.x,u.y):a.clearRect(u.x,u.y,Z.width,Z.height)})}})},be=(e,t)=>(n,r)=>{if(t.zoom()>=e.canvasMgr.zoom())return;const{rect:i,chunkDelta:a}=e.canvasMgr,l=null===i.canvasSizeLogicalPx.width()||null===i.canvasSizeLogicalPx.height()?null:{width:i.canvasSizeLogicalPx.width(),height:i.canvasSizeLogicalPx.height()},u=null===i.originOffsetPx.x()||null===i.originOffsetPx.y()?null:{x:i.originOffsetPx.x(),y:i.originOffsetPx.y()};if(!l||!u)return;n.width=l.width,n.height=l.height;const s=n.getContext("2d"),c=e.canvasMgr.zoom()/t.zoom(),d=1/c,h={width:Math.floor(l.width*d),height:Math.floor(l.height*d)},f=(e.canvasMgr.center.re()-t.center.re())*d/(1-d)/a.re()*Z.width+l.width/2,g=(e.canvasMgr.center.im()-t.center.im())*d/(1-d)/a.im()*Z.height+l.height/2,p={x:Math.round(f*(1-d)),y:Math.round(g*(1-d))},m=h.width*h.height*4,v=r&&r.byteLength>=m?r:new ArrayBuffer(m),w=new ImageData(new Uint8ClampedArray(v,0,m),h.width,h.height);return o.sample(()=>{const t={re:0,im:0},n={re:void 0,im:void 0};let r=null;for(let o=0;o<h.width*h.height;o++){const i=Math.floor(o/h.width)+.5,a=o%h.width+.5,l=Math.round(c*(i+p.y-g)+g-u.y-.5),s=Math.round(c*(a+p.x-f)+f-u.x-.5);if(t.re=Math.floor(s/Z.width),t.im=Math.floor(l/Z.height),r=t.re===n.re&&t.im===n.im?r:e.imager.imageData().get(t)(),n.re=t.re,n.im=t.im,r){const e=l-t.im*Z.height,n=s-t.re*Z.width,i=4*(e*Z.width+n);w.data[4*o]=r.data[i],w.data[4*o+1]=r.data[i+1],w.data[4*o+2]=r.data[i+2],w.data[4*o+3]=r.data[i+3]}else w.data[4*o+3]=0}}),s.clearRect(0,0,l.width,l.height),s.putImageData(w,p.x,p.y),v},ke=(e,t,n)=>r=>{let i,a=0,l=0;const u=e=>{0!==e.button||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||(n(!0),a=e.clientX,l=e.clientY)},s=r=>{if(n()){const n=a-r.clientX,u=l-r.clientY;a=r.clientX,l=r.clientY,o.freeze(()=>o.sample(()=>{t.center.re(t.center.re()+n*t.resolution()/Z.width*e.canvasMgr.chunkDelta.re()),t.center.im(t.center.im()+u*t.resolution()/Z.height*e.canvasMgr.chunkDelta.im())})),void 0===i&&(i=setTimeout(d,50))}},c=()=>n(!1),d=()=>{i=void 0,o.freeze(()=>{t.center.re.commit(),t.center.im.commit()})};r.addEventListener("mousedown",u),document.addEventListener("mousemove",s),document.addEventListener("mouseup",c),o.cleanup(()=>{r.removeEventListener("mousedown",u),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",c)})},Me=(e,t)=>n=>{let r,i,a,l=0;const u=o=>{if(o.preventDefault(),l+=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY,void 0===r){const i=n.getBoundingClientRect(),a=o.clientX-(i.left+i.width/2),l=o.clientY-(i.top+i.height/2);r={re:t.center.re()+Math.sign(e.canvasMgr.chunkDelta.re())*a/t.zoom(),im:t.center.im()+Math.sign(e.canvasMgr.chunkDelta.im())*l/t.zoom()}}void 0===i&&(i=setTimeout(s,10)),void 0!==a&&clearTimeout(a),a=setTimeout(c,100)},s=()=>{const e=l;if(l=0,i=void 0,Math.abs(e/10)>=.5){const n=Math.pow(Math.abs(1/450*e),.8),i=Math.pow(2/(1+Math.exp(-n)),e<=0?1:-1);o.freeze(()=>{t.zoom(t.zoom()*i),t.center.re((1-1/i)*r.re+t.center.re()/i),t.center.im((1-1/i)*r.im+t.center.im()/i)})}},c=()=>o.freeze(()=>{r=void 0,t.zoom.commit(),t.center.re.commit(),t.center.im.commit()});n.addEventListener("wheel",u),o.cleanup(()=>n.removeEventListener("wheel",u))},ze=({app:e,mounted:t})=>(function(){var n,r,i;return r=X("",n=K("div","app",null)),i=X("",n),o(function(t){return O(t,(({app:e})=>(function(){var t,n,r,i,a,l,u,s,c,d,h,f;return K("label","setting-label",n=K("div","setting setting-c",t=K("div","settings",null))).textContent="c",r=K("input",null,n),i=X("",n),a=K("input",null,n),l=X("",n),K("label","setting-label",u=K("div","setting setting-max-iter",t)).textContent="Max. iter.",s=K("input",null,u),K("label","setting-label",c=K("div","setting setting-escape-radius",t)).textContent="Escape Radius",d=K("input",null,c),h=X("",t),f=X("",t),o(function(){r.value=e.runner.c.re(),r.onchange=(t=>e.runner.c.re(+t.currentTarget.value))}),o(function(e){return O(e," + ")},{start:i,end:i}),o(function(){a.value=e.runner.c.im(),a.onchange=(t=>e.runner.c.im(+t.currentTarget.value))}),o(function(e){return O(e," i")},{start:l,end:l}),o(function(){s.value=e.runner.maxIter(),s.onchange=(t=>e.runner.maxIter(+t.currentTarget.value))}),o(function(){d.value=e.runner.escapeRadius(),d.onchange=(t=>e.runner.escapeRadius(+t.currentTarget.value))}),o(function(t){return O(t,me({app:e}))},{start:h,end:h}),o(function(t){return O(t,pe({app:e}))},{start:f,end:f}),t})())({app:e}))},{start:r,end:r}),o(function(n){return O(n,(({app:e,mounted:t})=>{const n=xe(e),r=o.value(!1);return function(){var i;return i=K("canvas",null,null),o(function(){i.className=ve("julia-canvas",{panning:r()})}),o(function(r){return Ce(e,n,t)(i,r)}),o(function(t){return ye(e,n)(i,t)}),o(function(t){return be(e,n)(i,t)}),o(function(t){return ke(e,n,r)(i,t)}),o(function(t){return Me(e,n)(i,t)}),i}()})({app:e,mounted:t}))},{start:i,end:i}),n})(),Se=o.data(!1),Le=o.root(()=>{const e=(()=>{const e=o.data(window.location.hash),t=o.data(window.location.hash),n=t=>void 0===t?e():r(t,!1),r=(n,r)=>o.freeze(()=>(e(n),r&&t(n),window.location[r?"assign":"replace"](n),n));n.change=(e=>void 0===e?t():r(e,!0));const i=()=>o.freeze(()=>{(window.location.hash||"#")!==e()&&e(t(window.location.hash))});return window.addEventListener("hashchange",i),o.cleanup(()=>window.removeEventListener("hashchange",i)),n})(),t=o(()=>{const t=e.change().indexOf("?");return t>=0?e.change().slice(t+1):""}),n=Q(o.sample(t)),r=ge(window.WORKER_URL,n);return o(()=>e("#?"+function(e){const t=new URLSearchParams;return t.set("c_re",""+e.escapeTime.c.re),t.set("c_im",""+e.escapeTime.c.im),t.set("ctr_re",""+e.canvas.center.re),t.set("ctr_im",""+e.canvas.center.im),t.set("zoom",""+e.canvas.zoom),t.set("color_in",e.imager.includedColor.toString({hideHash:!0})),t.set("color_out",e.imager.excludedColor.toString({hideHash:!0})),t.set("res",""+e.canvas.resolution),t.set("iter",""+e.escapeTime.maxIter),t.set("rad",""+e.escapeTime.escapeRadius),t.toString()}(r.currentOpts()))),o.on(t,()=>r.updateOpts(Q(t()))),ze({app:r,mounted:Se})});document.querySelector("#app").appendChild(Le),Se(!0)}]);
//# sourceMappingURL=main.262d450a5ba5c5a34d53.js.map